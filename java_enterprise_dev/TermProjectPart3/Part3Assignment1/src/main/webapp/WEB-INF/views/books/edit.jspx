<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<div xmlns:jsp="http://java.sun.com/JSP/Page"
     xmlns:c="http://java.sun.com/jsp/jstl/core"
     xmlns:spring="http://www.springframework.org/tags"
     xmlns:form="http://www.springframework.org/tags/form"
     version="2.0">
    <jsp:directive.page contentType="text/html;charset=UTF-8"/>
    <jsp:output omit-xml-declaration="yes"/>

    <!-- add spring messaging for i18n -->
    <spring:message code="label_book_information" var="labelBookInformation"/>
    <spring:message code="label_book_title" var="labelBookTitle"/>
    <spring:message code="label_book_publisher" var="labelBookPublisher"/>
    <spring:message code="label_book_price" var="labelBookPrice"/>
    <spring:message code="label_book_category" var="labelBookCategory"/>
    <spring:message code="label_book_isbn" var="labelBookISBN"/>
    <spring:message code="label_book_update" var="labelBookUpdate"/>
    <spring:message code="label_book_new" var="labelBookNew"/>

    <!-- add spring url for edit book page -->
    <spring:url value="/books" var="editBookUrl"/>

    <!-- spring expression for new book v update book -->
    <spring:eval expression="book.id == null ? labelBookNew:labelBookUpdate" var="formHeader"/>

    <h1>${formHeader}</h1>

    <!-- create spring form for editing and creating a new book -->
    <div id="bookUpdate">
        <form:form modelAttribute="book" id="bookUpdateForm" method="post"
                   enctype="application/x-www-form-urlencoded">

            <c:if test="${not empty message}">
                <div id="message" class="alert alert-primary" role="alert">
                    ${message.message}
                </div>
            </c:if>

            <div class="form-group">
                <form:label path="title">
                    ${labelBookTitle}*
                </form:label>
                <form:input path="title" cssClass="form-control"/>
                <div>
                    <form:errors path="title" cssClass="invalid-feedback display" />
                </div>
            </div>
            <div class="form-group">
                <form:label path="isbn">
                    ${labelBookISBN}*
                </form:label>
                <form:input path="isbn" cssClass="form-control"/>
                <div>
                    <form:errors path="isbn" cssClass="invalid-feedback display" />
                </div>
            </div>
            <div class="form-group">
                <form:label path="category">
                    ${labelBookCategory}
                </form:label>
                <form:input path="category" cssClass="form-control"/>
                <div>
                    <form:errors path="category" cssClass="invalid-feedback display" />
                </div>
            </div>
            <div class="form-group">
                <form:label path="publisher">
                    ${labelBookPublisher}
                </form:label>
                <form:input path="publisher" cssClass="form-control"/>
                <div>
                    <form:errors path="publisher" cssClass="invalid-feedback display" />
                </div>
            </div>
            <div class="form-group">
                <form:label path="price">
                    ${labelBookPrice}
                </form:label>
                <form:input path="price" cssClass="form-control"/>
                <div>
                    <form:errors path="price" cssClass="invalid-feedback display" />
                </div>
            </div>
            <button type="submit" class="btn btn-primary mx-1">Save</button>
            <button type="reset" class="btn btn-primary mx-1">Reset</button>
        </form:form>

        <c:if test="${book.id != null}">
            <form:form modelAttribute="book" id="bookUpdateForm" method="post" enctype="application/x-www-form-urlencoded">
                <input type="hidden" name="_method" value="delete"/>
                <button type="submit" class="btn btn-danger m-1">Delete</button>
            </form:form>
        </c:if>
    </div>
</div>